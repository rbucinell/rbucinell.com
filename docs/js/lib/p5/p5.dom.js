!function(t,e){"function"==typeof define&&define.amd?define("p5.dom",["p5"],function(t){e(t)}):"object"==typeof exports?e(require("../p5")):e(t.p5)}(this,function(h){function l(t){var e=document;return"string"==typeof t&&"#"===t[0]?(t=t.slice(1),e=document.getElementById(t)||document):t instanceof h.Element?e=t.elt:t instanceof HTMLElement&&(e=t),e}function a(t){if("INPUT"===t.tagName&&"checkbox"===t.type){var e=new h.Element(t);return e.checked=function(){return 0===arguments.length?this.elt.checked:(arguments[0]?this.elt.checked=!0:this.elt.checked=!1,this)},e}return"VIDEO"===t.tagName||"AUDIO"===t.tagName?new h.MediaElement(t):"SELECT"===t.tagName?createSelect(new h.Element(t)):new h.Element(t)}function d(t,e,i){(e._userNode?e._userNode:document.body).appendChild(t);var n=i?new h.MediaElement(t):new h.Element(t);return e._elements.push(n),n}h.prototype.select=function(t,e){var i=null,n=l(e);return"."===t[0]?(t=t.slice(1),i=(i=n.getElementsByClassName(t)).length?i[0]:null):"#"===t[0]?(t=t.slice(1),i=n.getElementById(t)):i=(i=n.getElementsByTagName(t)).length?i[0]:null,i?a(i):null},h.prototype.selectAll=function(t,e){var i,n=[],o=l(e);if("."===t[0]?(t=t.slice(1),i=o.getElementsByClassName(t)):i=o.getElementsByTagName(t),i)for(var s=0;s<i.length;s++){var r=a(i[s]);n.push(r)}return n},h.prototype.removeElements=function(t){for(var e=0;e<this._elements.length;e++)this._elements[e].elt instanceof HTMLCanvasElement||this._elements[e].remove()};function i(t,e,i,n){var o=document.createElement(e);"string"==typeof(i=i||"")&&(i=[i]);for(var s=0;s<i.length;s++){var r=document.createElement("source");r.src=i[s],o.appendChild(r)}if(void 0!==n){var l=function(){n(),o.removeEventListener("canplaythrough",l)};o.addEventListener("canplaythrough",l)}var h=d(o,t,!0);return h.loadedmetadata=!1,o.addEventListener("loadedmetadata",function(){h.width=o.videoWidth,h.height=o.videoHeight,0===h.elt.width&&(h.elt.width=o.videoWidth),0===h.elt.height&&(h.elt.height=o.videoHeight),h.loadedmetadata=!0}),h}["div","p","span"].forEach(function(i){var t="create"+i.charAt(0).toUpperCase()+i.slice(1);h.prototype[t]=function(t){var e=document.createElement(i);return e.innerHTML=void 0===typeof t?"":t,d(e,this)}}),h.prototype.createImg=function(){var t,e=document.createElement("img"),i=arguments;return e.src=i[0],1<i.length&&"string"==typeof i[1]&&(e.alt=i[1]),e.onload=function(){t.width=e.offsetWidth||e.width,t.height=e.offsetHeight||e.height,1<i.length&&"function"==typeof i[1]?(t.fn=i[1],t.fn()):1<i.length&&"function"==typeof i[2]&&(t.fn=i[2],t.fn())},t=d(e,this)},h.prototype.createA=function(t,e,i){var n=document.createElement("a");return n.href=t,n.innerHTML=e,i&&(n.target=i),d(n,this)},h.prototype.createSlider=function(t,e,i,n){var o=document.createElement("input");return o.type="range",o.min=t,o.max=e,0===n?o.step=1e-18:n&&(o.step=n),"number"==typeof i&&(o.value=i),d(o,this)},h.prototype.createButton=function(t,e){var i=document.createElement("button");return i.innerHTML=t,e&&(i.value=e),d(i,this)},h.prototype.createCheckbox=function(){var t=document.createElement("div"),e=document.createElement("input");e.type="checkbox",t.appendChild(e);var i=d(t,this);if(i.checked=function(){var t=i.elt.getElementsByTagName("input")[0];if(t){if(0===arguments.length)return t.checked;arguments[0]?t.checked=!0:t.checked=!1}return i},this.value=function(t){return i.value=t,this},arguments[0]){var n=Math.random().toString(36).slice(2),o=document.createElement("label");e.setAttribute("id",n),o.htmlFor=n,i.value(arguments[0]),o.appendChild(document.createTextNode(arguments[0])),t.appendChild(o)}return arguments[1]&&(e.checked=!0),i},h.prototype.createSelect=function(){var s,t,n=arguments[0];return"object"==typeof n&&"SELECT"===n.elt.nodeName?(t=n,s=this.elt=n.elt):(s=document.createElement("select"),n&&"boolean"==typeof n&&s.setAttribute("multiple","true"),t=d(s,this)),t.option=function(t,e){for(var i,n=0;n<this.elt.length;n++)if(this.elt[n].innerHTML==t){i=n;break}if(void 0!==i)!1===e?this.elt.remove(i):this.elt[i].innerHTML==this.elt[i].value?this.elt[i].innerHTML=this.elt[i].value=e:this.elt[i].value=e;else{var o=document.createElement("option");o.innerHTML=t,1<arguments.length?o.value=e:o.value=t,s.appendChild(o)}},t.selected=function(t){var e=[];if(0<arguments.length){for(var i=0;i<this.elt.length;i++)t.toString()===this.elt[i].value&&(this.elt.selectedIndex=i);return this}if(n){for(i=0;i<this.elt.selectedOptions.length;i++)e.push(this.elt.selectedOptions[i].value);return e}return this.elt.value},t},h.prototype.createRadio=function(){var t=document.querySelectorAll("input[type=radio]"),o=0;if(1<t.length)for(var e=t.length,i=t[0].name,n=t[1].name,s=o=1;s<e;s++)i!=(n=t[s].name)&&o++,i=n;else 1==t.length&&(o=1);var r=document.createElement("div"),l=d(r,this),h=-1;return l.option=function(t,e){var i=document.createElement("input");if(i.type="radio",i.innerHTML=t,1<arguments.length?i.value=e:i.value=t,i.setAttribute("name","defaultradio"+o),r.appendChild(i),t){h++;Math.random().toString(36).slice(2);var n=document.createElement("label");i.setAttribute("id","defaultradio"+o+"-"+h),n.htmlFor="defaultradio"+o+"-"+h,n.appendChild(document.createTextNode(t)),r.appendChild(n)}return i},l.selected=function(){var t=this.elt.childNodes.length;if(1==arguments.length){for(var e=0;e<t;e+=2)this.elt.childNodes[e].value==arguments[0]&&(this.elt.childNodes[e].checked=!0);return this}for(e=0;e<t;e+=2)if(1==this.elt.childNodes[e].checked)return this.elt.childNodes[e].value},l.value=function(){var t=this.elt.childNodes.length;if(1==arguments.length){for(var e=0;e<t;e+=2)this.elt.childNodes[e].value==arguments[0]&&(this.elt.childNodes[e].checked=!0);return this}for(e=0;e<t;e+=2)if(1==this.elt.childNodes[e].checked)return this.elt.childNodes[e].value;return""},l},h.prototype.createInput=function(t,e){var i=document.createElement("input");return i.type=e||"text",t&&(i.value=t),d(i,this)},h.prototype.createFileInput=function(r,t){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var e=document.createElement("input");return e.type="file",t&&(e.multiple="multiple"),e.addEventListener("change",function(t){for(var e=t.target.files,i=0;i<e.length;i++){var n=e[i],o=new FileReader;function s(t){var e=new h.File(t);return function(t){e.data=t.target.result,r(e)}}o.onload=s(n),-1<n.type.indexOf("text")?o.readAsText(n):o.readAsDataURL(n)}},!1),d(e,this)}console.log("The File APIs are not fully supported in this browser. Cannot create element.")},h.prototype.createVideo=function(t,e){return i(this,"video",t,e)},h.prototype.createAudio=function(t,e){return i(this,"audio",t,e)},h.prototype.VIDEO="video",h.prototype.AUDIO="audio",navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,h.prototype.createCapture=function(){for(var t,e,i=!0,n=!0,o=0;o<arguments.length;o++)arguments[o]===h.prototype.VIDEO?n=!1:arguments[o]===h.prototype.AUDIO?i=!1:"object"==typeof arguments[o]?t=arguments[o]:"function"==typeof arguments[o]&&(e=arguments[o]);if(!navigator.getUserMedia)throw"getUserMedia not supported in this browser";var s=document.createElement("video");t||(t={video:i,audio:n}),navigator.getUserMedia(t,function(t){s.src=window.URL.createObjectURL(t),e&&e(t)},function(t){console.log(t)});var r=d(s,this,!0);return r.loadedmetadata=!1,s.addEventListener("loadedmetadata",function(){s.play(),s.width?(r.width=s.videoWidth=s.width,r.height=s.videoHeight=s.height):(r.width=r.elt.width=s.videoWidth,r.height=r.elt.height=s.videoHeight),r.loadedmetadata=!0}),r},h.prototype.createElement=function(t,e){var i=document.createElement(t);return void 0!==e&&(i.innerHTML=e),d(i,this)},h.Element.prototype.addClass=function(t){return this.elt.className?this.elt.className=this.elt.className+" "+t:this.elt.className=t,this},h.Element.prototype.removeClass=function(t){var e=new RegExp("(?:^|\\s)"+t+"(?!\\S)");return this.elt.className=this.elt.className.replace(e,""),this.elt.className=this.elt.className.replace(/^\s+|\s+$/g,""),this},h.Element.prototype.child=function(t){return void 0===t?this.elt.childNodes:("string"==typeof t?("#"===t[0]&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof h.Element&&(t=t.elt),this.elt.appendChild(t),this)},h.Element.prototype.center=function(t){var e=this.elt.style.display,i="none"===this.elt.style.display,n="none"===this.parent().style.display,o={x:this.elt.offsetLeft,y:this.elt.offsetTop};i&&this.show(),this.elt.style.display="block",this.position(0,0),n&&(this.parent().style.display="block");var s=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth),r=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight),l=o.y,h=o.x;return"both"===t||void 0===t?this.position(s/2,r/2):"horizontal"===t?this.position(s/2,l):"vertical"===t&&this.position(h,r/2),this.style("display",e),i&&this.hide(),n&&(this.parent().style.display="none"),this},h.Element.prototype.html=function(){return 0===arguments.length?this.elt.innerHTML:(arguments[1]?this.elt.innerHTML+=arguments[0]:this.elt.innerHTML=arguments[0],this)},h.Element.prototype.position=function(){return 0===arguments.length?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position="absolute",this.elt.style.left=arguments[0]+"px",this.elt.style.top=arguments[1]+"px",this.x=arguments[0],this.y=arguments[1],this)},h.Element.prototype._translate=function(){this.elt.style.position="absolute";var t="";return this.elt.style.transform&&(t=(t=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),2===arguments.length?this.elt.style.transform="translate("+arguments[0]+"px, "+arguments[1]+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",3===arguments.length?this.elt.parentElement.style.perspective="1000px":this.elt.parentElement.style.perspective=arguments[3]+"px"),this.elt.style.transform+=t,this},h.Element.prototype._rotate=function(){var t="";this.elt.style.transform&&(t=(t=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,""));return 1===arguments.length?this.elt.style.transform="rotate("+arguments[0]+"deg)":2===arguments.length?this.elt.style.transform="rotate("+arguments[0]+"deg, "+arguments[1]+"deg)":3===arguments.length&&(this.elt.style.transform="rotateX("+arguments[0]+"deg)",this.elt.style.transform+="rotateY("+arguments[1]+"deg)",this.elt.style.transform+="rotateZ("+arguments[2]+"deg)"),this.elt.style.transform+=t,this},h.Element.prototype.style=function(t,e){if(e instanceof h.Color&&(e="rgba("+e.levels[0]+","+e.levels[1]+","+e.levels[2]+","+e.levels[3]/255+")"),void 0===e){if(-1===t.indexOf(":"))return window.getComputedStyle(this.elt).getPropertyValue(t);for(var i=t.split(";"),n=0;n<i.length;n++){var o=i[n].split(":");o[0]&&o[1]&&(this.elt.style[o[0].trim()]=o[1].trim())}}else if("rotate"===t||"translate"===t||"position"===t){var s=Array.prototype.shift.apply(arguments);(this[s]||this["_"+s]).apply(this,arguments)}else if(this.elt.style[t]=e,"width"===t||"height"===t||"left"===t||"top"===t){var r=e.replace(/\D+/g,"");this[t]=parseInt(r,10)}return this},h.Element.prototype.attribute=function(t,e){if(null==this.elt.firstChild||"checkbox"!==this.elt.firstChild.type&&"radio"!==this.elt.firstChild.type)return void 0===e?this.elt.getAttribute(t):(this.elt.setAttribute(t,e),this);if(void 0===e)return this.elt.firstChild.getAttribute(t);for(var i=0;i<this.elt.childNodes.length;i++)this.elt.childNodes[i].setAttribute(t,e)},h.Element.prototype.removeAttribute=function(t){if(null!=this.elt.firstChild&&("checkbox"===this.elt.firstChild.type||"radio"===this.elt.firstChild.type))for(var e=0;e<this.elt.childNodes.length;e++)this.elt.childNodes[e].removeAttribute(t);return this.elt.removeAttribute(t),this},h.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments[0],this):"range"===this.elt.type?parseFloat(this.elt.value):this.elt.value},h.Element.prototype.show=function(){return this.elt.style.display="block",this},h.Element.prototype.hide=function(){return this.elt.style.display="none",this},h.Element.prototype.size=function(t,e){if(0===arguments.length)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var i=t,n=e,o=h.prototype.AUTO;if(i!==o||n!==o){if(i===o?i=e*this.width/this.height:n===o&&(n=t*this.height/this.width),this.elt instanceof HTMLCanvasElement){var s={},r=this.elt.getContext("2d");for(var l in r)s[l]=r[l];for(var l in this.elt.setAttribute("width",i*this._pInst._pixelDensity),this.elt.setAttribute("height",n*this._pInst._pixelDensity),this.elt.setAttribute("style","width:"+i+"px; height:"+n+"px"),this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),s)this.elt.getContext("2d")[l]=s[l]}else this.elt.style.width=i+"px",this.elt.style.height=n+"px",this.elt.width=i,this.elt.height=n,this.width=i,this.height=n;this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this._pInst&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this},h.Element.prototype.remove=function(){for(var t in this._events)this.elt.removeEventListener(t,this._events[t]);this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},h.MediaElement=function(n,t){h.Element.call(this,n,t);var o=this;this.elt.crossOrigin="anonymous",this._prevTime=0,this._cueIDCounter=0,this._cues=[],this._pixelDensity=1,Object.defineProperty(o,"src",{get:function(){var t=o.elt.children[0].src,e=o.elt.src===window.location.href?"":o.elt.src;return t===window.location.href?e:t},set:function(t){for(var e=0;e<o.elt.children.length;e++)o.elt.removeChild(o.elt.children[e]);var i=document.createElement("source");i.src=t,n.appendChild(i),o.elt.src=t}}),o._onended=function(){},o.elt.onended=function(){o._onended(o)}},h.MediaElement.prototype=Object.create(h.Element.prototype),h.MediaElement.prototype.play=function(){return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),1<this.elt.readyState||this.elt.load(),this.elt.play(),this},h.MediaElement.prototype.stop=function(){return this.elt.pause(),this.elt.currentTime=0,this},h.MediaElement.prototype.pause=function(){return this.elt.pause(),this},h.MediaElement.prototype.loop=function(){return this.elt.setAttribute("loop",!0),this.play(),this},h.MediaElement.prototype.noLoop=function(){return this.elt.setAttribute("loop",!1),this},h.MediaElement.prototype.autoplay=function(t){return this.elt.setAttribute("autoplay",t),this},h.MediaElement.prototype.volume=function(t){if(void 0===t)return this.elt.volume;this.elt.volume=t},h.MediaElement.prototype.speed=function(t){if(void 0===t)return this.elt.playbackRate;this.elt.playbackRate=t},h.MediaElement.prototype.time=function(t){if(void 0===t)return this.elt.currentTime;this.elt.currentTime=t},h.MediaElement.prototype.duration=function(){return this.elt.duration},h.MediaElement.prototype.pixels=[],h.MediaElement.prototype.loadPixels=function(){return this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d")),this.loadedmetadata&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),h.Renderer2D.prototype.loadPixels.call(this)),this},h.MediaElement.prototype.updatePixels=function(t,e,i,n){return this.loadedmetadata&&h.Renderer2D.prototype.updatePixels.call(this,t,e,i,n),this},h.MediaElement.prototype.get=function(t,e,i,n){return this.loadedmetadata?h.Renderer2D.prototype.get.call(this,t,e,i,n):void 0===t?new h.Image(1,1):1<i?new h.Image(t,e,i,n):[0,0,0,255]},h.MediaElement.prototype.set=function(t,e,i){this.loadedmetadata&&h.Renderer2D.prototype.set.call(this,t,e,i)},h.MediaElement.prototype.copy=function(){h.Renderer2D.prototype.copy.apply(this,arguments)},h.MediaElement.prototype.mask=function(){this.loadPixels(),h.Image.prototype.mask.apply(this,arguments)},h.MediaElement.prototype.onended=function(t){return this._onended=t,this},h.MediaElement.prototype.connect=function(t){var e,i;if("function"==typeof h.prototype.getAudioContext)e=h.prototype.getAudioContext(),i=h.soundOut.input;else try{i=(e=t.context).destination}catch(t){throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=e.createMediaElementSource(this.elt),this.audioSourceNode.connect(i)),t?t.input?this.audioSourceNode.connect(t.input):this.audioSourceNode.connect(t):this.audioSourceNode.connect(i)},h.MediaElement.prototype.disconnect=function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()},h.MediaElement.prototype.showControls=function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0},h.MediaElement.prototype.hideControls=function(){this.elt.controls=!1},h.MediaElement.prototype.addCue=function(t,e,i){var n=this._cueIDCounter++,o=new s(e,t,n,i);return this._cues.push(o),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),n},h.MediaElement.prototype.removeCue=function(t){for(var e=0;e<this._cues.length;e++)this._cues[e]===t&&(console.log(t),this._cues.splice(e,1));0===this._cues.length&&(this.elt.ontimeupdate=null)},h.MediaElement.prototype.clearCues=function(){this._cues=[],this.elt.ontimeupdate=null},h.MediaElement.prototype._onTimeUpdate=function(){for(var t=this.time(),e=0;e<this._cues.length;e++){var i=this._cues[e].time,n=this._cues[e].val;this._prevTime<i&&i<=t&&this._cues[e].callback(n)}this._prevTime=t};var s=function(t,e,i,n){this.callback=t,this.time=e,this.id=i,this.val=n};h.File=function(t,e){this.file=t,this._pInst=e;var i=t.type.split("/");this.type=i[0],this.subtype=i[1],this.name=t.name,this.size=t.size,this.data=void 0}});