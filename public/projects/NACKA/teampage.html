<!DOCTYPE html>
<!--THIS PAGE IS GENERATED BY JADE. DO NOT EDIT, YOU'LL LOSE YOUR CHANGES-->
<html>
  <head>
    <title>NACKA App</title>
    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="viewport" content="width=device-width" initial-scale="1.0">
    <link rel="stylesheet" href="http://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="css/materialize.min.css" media="screen,projection">
    <link rel="stylesheet" href="css/nacka_styles.css">
  </head>
  <body>
    <header>
      <nav class="top-nav">
        <div class="container"><a hef="#" data-activates="slide-out" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
          <div class="nav-wrapper"><a class="page-title">NACKA | </a></div>
          <ul id="slide-out" class="side-nav white">
            <li class="logo"><a id="logo-container" href="http://www.rbucinell.com" class="brand-logo"><img src="img/nacka_logo.svg" alt="NACKA Logo"></a></li>
            <ul data-collapsible="accordian" class="collapsible collapsible-accordion">
              <li class="grey darken-3"><a class="collapsible-header white-text waves-effect waves-red">NACKA News</a>
                <div class="collapsible-body">
                  <ul>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">News</a></li>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Photos</a></li>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Videos</a></li>
                  </ul>
                </div>
              </li>
              <li class="grey darken-3"><a class="collapsible-header white-text waves-effect waves-red">Schedules</a>
                <div class="collapsible-body">
                  <ul>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">All Teams</a></li>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">My Teams</a></li>
                              <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Tonight's Games</a></li>
                  </ul>
                </div>
              </li>
            </ul>
                      <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Fields</a></li>
                      <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Rules</a></li>
                      <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">About</a></li>
                      <li class="grey darken-3"><a href="#!" class="white-text waves-effect waves-red">Home</a></li>
          </ul>
        </div>
      </nav>
    </header>
    <main>
      <div class="page-content container">
        <div class="row">
          <div class="col s12">
            <div id="teamBanner" class="card">
              <div class="card-content white-text"><span id="teamNameTitle" class="card-title"></span><br><span class="badge">
                  <div id="teamWins" class="chip green">W:#</div>
                  <div id="teamLosses" class="chip red">L:#</div></span></div>
            </div>
          </div>
          <div class="col s12">
            <ul id="matchups" class="collection">
            </ul>
          </div>
        </div>
      </div>
      <div id="registerbutton" style="height:80px; top: 56px; right: 10px;" class="fixed-action-btn"><a class="btn-floating btn-large waves-effect waves-light red"><i class="material-icons">add</i></a></div>
    </main>
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/materialize.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/Colors.js"></script>
    <script src="js/Team.js"></script>
    <script src="js/Matchup.js"></script>
    <script>$(".button-collapse").sideNav();</script>
    <script>
      $(function(){
          var queryVars = getUrlQueryStringValues();
          var teamName = decodeURIComponent(queryVars.name);
          $(".page-title").text( "NACKA | " + teamName);
          
          var team = Team.GetTeamByName(teamName);
          Team.SetElementBackground( $("#teamBanner"),team );
          
          $("#teamNameTitle").text( team.Name );
          
          if( team.matchups.length === 0)
          {
              var url = ROOT_URL + team.URL;
              var yql = getYqlUrlForPage( url );
              $.getJSON( yql, readYQL);
          }else {
              populateCollection( team );
          }             
          
          
          function readYQL( data )
          {
              App.RemoveData("ALL_TEAMS");
              var htmlbody = data.query.results.body;
              var scheduleTable = htmlbody.table[2].tbody.tr.td[1].table.tbody;
              for( i in scheduleTable.tr )
              {
                  var trMatch = scheduleTable.tr[i];
                  var match = new Matchup();
                  match.buildMatchFromRawTR( trMatch );
                  team.matchups.push( match );
              }
              App.SaveData( "ALL_TEAMS", Team.ALL_TEAMS );
              
              
              populateCollection(team);
          };
          
          function populateCollection( team )
          {                    
              for( var i = 0; i < team.matchups.length; i++ )
              {
                  var matchup = team.matchups[i];
                  
                  //create the list item
                  var newli = $("<li class=\"collection-item dismissable avatar tshirt-avatar\"></li>");
                  //-newli.css('background-color', Colors.NACKA_GRAY_BG_LIGHT )
      
                  //tshirt image
                  var newIMG =$("<img class=\"circle tshirt-img\" src=\"img/shirt_hollow_template_white.png\">");
                  //var newIMG =$("<img class=\"circle tshirt-img\" src=\"img/shirt_hollow_template_light.png\">");
                  Team.SetElementBackground( newIMG, matchup.Opponent );
                  $(newli).append(newIMG);	
                  
                  
                  var newTitle = $("<span class=\"title\"></span>").text("["+matchup.Location+"] " + matchup.Opponent.Name);
                  $(newli).append(newTitle);	
                  
                  var matchupParagraph = matchup.MatchDateTime.WeekDay() + ", " + matchup.MatchDateTime.getMonth() + "/" +  matchup.MatchDateTime.getDate() + " on Field #" + matchup.Field;
                  var newP = $("<p></p>").text( matchupParagraph );
                  
                  var secondary = $("<div class=\"secondary-content\"></div>");
                  var secondaryImg = $("<img class=\"avatar field-avatar\" src=\"img/field1.png\">");
                  $(secondary).append(secondaryImg);
                  $(newP).append(secondary);
                  
                  $(newli).append( newP );
                  
                  if( matchup.MatchDateTime.toDateString() === new Date().toDateString())
                  {
                      $(newli).append($("<div class=\"chip\"></div>").text( "Game Tonight!"));
                  }
                  
                  //Lastly add it to the UL
                  $("#matchups").append( newli );  
                                    
              }  
          };
          
          $("#registerbutton a").click(function(){
              $("#registerbutton a").removeClass("red").addClass("green");
              Materialize.toast( "The team was registered", 2000);
              $("#registerbutton > a > i.material-icons").text( "star" )
          });
      });
    </script>
  </body>
</html>